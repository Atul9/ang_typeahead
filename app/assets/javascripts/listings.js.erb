var app =angular.module('typeahead', []);
app.controller('Ctrl', ['$scope', '$http', function($scope, $http){
  $scope.getData = function(input){
    $http({
      url: "<%= Rails.application.routes.url_helpers.search_path %>",
        dataType: 'json',
        method: 'POST',
        data: {
          search: $scope.countries
        },
        headers: {
          "Content-Type": "application/json"
        }

    }).then(function successCallback(response){
      $scope.names = response.data.names;
    });
  }
  $scope.setName = function(input){
    $("#myinput").val($scope.names[input]);
  }
}]);
$(document).ready(function(){
  $('#myinput').keyup( function() {
    if( this.value.length < 3 ) return;
    angular.element($("#myinput")).scope().getData();
  });
});
